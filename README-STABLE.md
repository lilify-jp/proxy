# Web Proxy - 安定版ガイド

このドキュメントでは、Webプロキシを安定して使用するための方法を説明します。

## エラーが発生する場合の対処法

### 推奨の起動方法

1. **安定モードで起動する**
   - `stable-proxy.bat` をダブルクリックしてサーバーを起動します
   - これにより、以下の機能が有効になります：
     - メモリ制限の拡大（4GB）
     - ガベージコレクションの有効化
     - サーバーの自動再起動
     - ブラウザの自動起動

2. **オプション設定を変更する**
   - 「スクリプトを削除」オプションをオンにする
   - 「フレームを削除」オプションをオンにする
   - タイムアウト値を60秒に増やす

### エラーの種類と対処法

#### 1. "Failed to fetch" エラー

**原因**:
- サーバーが起動していない
- サーバーがクラッシュした
- ネットワーク接続の問題

**対処法**:
- サーバーが実行中であることを確認する
- `stable-proxy.bat` を使用して再起動する
- ファイアウォールの設定を確認する

#### 2. "Cannot set headers after they are sent" エラー

**原因**:
- サーバー側でのレスポンス処理の問題
- 同じリクエストに対して複数回レスポンスを送信しようとしている

**対処法**:
- サーバーを再起動する
- キャッシュをクリアする（自動的に行われます）

#### 3. "Assignment to constant variable" エラー

**原因**:
- サーバーコードの問題
- 変数の再代入エラー

**対処法**:
- 最新バージョンのコードを使用する
- サーバーを再起動する

#### 4. メモリ不足エラー

**原因**:
- 大きなウェブサイトの処理
- メモリリーク

**対処法**:
- `stable-proxy.bat` を使用する（メモリ制限が4GBに増加）
- 「スクリプトを削除」オプションをオンにする
- 複雑なウェブサイトへのアクセスを控える

## 安定性を向上させるためのヒント

1. **定期的にサーバーを再起動する**
   - 長時間の使用後は、サーバーを再起動することでメモリリークの影響を軽減できます

2. **キャッシュを活用する**
   - 同じサイトに繰り返しアクセスする場合、キャッシュが自動的に使用されます
   - これにより、エラーの発生を減らすことができます

3. **シンプルなサイトから始める**
   - 最初に小さなウェブサイトにアクセスしてから、より複雑なサイトにアクセスしてください

4. **エラーが発生した場合は再試行する**
   - エラーが発生した場合は、「再試行」ボタンをクリックするか、URLを再入力してアクセスしてください

## トラブルシューティング

問題が解決しない場合は、以下の手順を試してください：

1. すべてのNode.jsプロセスを終了する
   - タスクマネージャーでNode.jsプロセスを終了する
   - または `taskkill /f /im node.exe` コマンドを実行する

2. `node_modules` フォルダを削除して依存関係を再インストールする
   - `rd /s /q node_modules` コマンドを実行
   - `npm install` コマンドを実行

3. システムを再起動する
   - メモリやネットワークの問題をリセットするために効果的です